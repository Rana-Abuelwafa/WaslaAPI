[2025-07-21 17:24:43.041 +03:00  INF]  User profile is available. Using 'C:\Users\Pro\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-07-21 17:24:43.285 +03:00  WRN]  The WebRootPath was not found: D:\waslaa\api\WaslaAPI\Wasla_App\wwwroot. Static files may be unavailable.
[2025-07-21 17:24:43.480 +03:00  INF]  Now listening on: https://localhost:7283
[2025-07-21 17:24:43.481 +03:00  INF]  Now listening on: http://localhost:5074
[2025-07-21 17:24:43.711 +03:00  INF]  Application started. Press Ctrl+C to shut down.
[2025-07-21 17:24:43.712 +03:00  INF]  Hosting environment: Development
[2025-07-21 17:24:43.712 +03:00  INF]  Content root path: D:\waslaa\api\WaslaAPI\Wasla_App
[2025-07-21 17:24:44.296 +03:00  INF]  Request starting HTTP/2 GET https://localhost:7283/swagger/index.html - null null
[2025-07-21 17:24:45.519 +03:00  INF]  Request finished HTTP/2 GET https://localhost:7283/swagger/index.html - 200 null text/html;charset=utf-8 1231.9076ms
[2025-07-21 17:24:45.634 +03:00  INF]  Request starting HTTP/2 GET https://localhost:7283/_framework/aspnetcore-browser-refresh.js - null null
[2025-07-21 17:24:45.703 +03:00  INF]  Request finished HTTP/2 GET https://localhost:7283/_framework/aspnetcore-browser-refresh.js - 200 16503 application/javascript; charset=utf-8 69.0056ms
[2025-07-21 17:24:45.704 +03:00  INF]  Request starting HTTP/2 GET https://localhost:7283/_vs/browserLink - null null
[2025-07-21 17:24:45.851 +03:00  INF]  Request finished HTTP/2 GET https://localhost:7283/_vs/browserLink - 200 null text/javascript; charset=UTF-8 147.4391ms
[2025-07-21 17:24:45.987 +03:00  INF]  Request starting HTTP/2 GET https://localhost:7283/swagger/v1/swagger.json - null null
[2025-07-21 17:24:46.053 +03:00  INF]  Request finished HTTP/2 GET https://localhost:7283/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 65.4814ms
[2025-07-21 17:26:44.263 +03:00  INF]  Request starting HTTP/2 POST https://localhost:7283/api/WaslaClient/MakeClientInvoiceForPackages - application/json-patch+json 557
[2025-07-21 17:26:44.304 +03:00  INF]  CORS policy execution successful.
[2025-07-21 17:26:45.731 +03:00  INF]  Executing endpoint 'Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App)'
[2025-07-21 17:26:45.762 +03:00  INF]  Route matched with {action = "MakeClientInvoiceForPackages", controller = "WaslaClient"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MakeClientInvoiceForPackages(System.Collections.Generic.List`1[WaslaApp.Data.Models.invoices.InvoiceReq]) on controller Wasla_App.Controllers.WaslaClientController (Wasla_App).
[2025-07-21 17:29:07.601 +03:00  INF]  Executed action Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App) in 141834.8197ms
[2025-07-21 17:29:07.603 +03:00  INF]  Executed endpoint 'Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App)'
[2025-07-21 17:29:07.605 +03:00  ERR]  An unhandled exception has occurred while executing the request.
System.NullReferenceException: Object reference not set to an instance of an object.
   at Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages(List`1 lst) in D:\waslaa\api\WaslaAPI\Wasla_App\Controllers\WaslaClientController.cs:line 327
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.InvokeInnerFilterAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeNextResourceFilter>g__Awaited|25_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Rethrow(ResourceExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.InvokeFilterPipelineAsync()
--- End of stack trace from previous location ---
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Localization.RequestLocalizationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddlewareImpl.Invoke(HttpContext context)
[2025-07-21 17:29:07.647 +03:00  INF]  Request finished HTTP/2 POST https://localhost:7283/api/WaslaClient/MakeClientInvoiceForPackages - 500 null text/plain; charset=utf-8 143384.5482ms
[2025-07-21 17:35:44.995 +03:00  INF]  User profile is available. Using 'C:\Users\Pro\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2025-07-21 17:35:45.253 +03:00  WRN]  The WebRootPath was not found: D:\waslaa\api\WaslaAPI\Wasla_App\wwwroot. Static files may be unavailable.
[2025-07-21 17:35:45.576 +03:00  INF]  Now listening on: https://localhost:7283
[2025-07-21 17:35:45.577 +03:00  INF]  Now listening on: http://localhost:5074
[2025-07-21 17:35:45.877 +03:00  INF]  Application started. Press Ctrl+C to shut down.
[2025-07-21 17:35:45.877 +03:00  INF]  Hosting environment: Development
[2025-07-21 17:35:45.877 +03:00  INF]  Content root path: D:\waslaa\api\WaslaAPI\Wasla_App
[2025-07-21 17:35:46.331 +03:00  INF]  Request starting HTTP/2 GET https://localhost:7283/swagger/index.html - null null
[2025-07-21 17:35:46.667 +03:00  INF]  Request starting HTTP/2 GET https://localhost:7283/_framework/aspnetcore-browser-refresh.js - null null
[2025-07-21 17:35:46.675 +03:00  INF]  Request finished HTTP/2 GET https://localhost:7283/swagger/index.html - 200 null text/html;charset=utf-8 353.7641ms
[2025-07-21 17:35:46.682 +03:00  INF]  Request starting HTTP/2 GET https://localhost:7283/_vs/browserLink - null null
[2025-07-21 17:35:46.684 +03:00  INF]  Request finished HTTP/2 GET https://localhost:7283/_framework/aspnetcore-browser-refresh.js - 200 16503 application/javascript; charset=utf-8 17.1764ms
[2025-07-21 17:35:46.882 +03:00  INF]  Request finished HTTP/2 GET https://localhost:7283/_vs/browserLink - 200 null text/javascript; charset=UTF-8 200.4219ms
[2025-07-21 17:35:47.023 +03:00  INF]  Request starting HTTP/2 GET https://localhost:7283/swagger/v1/swagger.json - null null
[2025-07-21 17:35:47.080 +03:00  INF]  Request finished HTTP/2 GET https://localhost:7283/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 57.9925ms
[2025-07-21 17:36:28.205 +03:00  INF]  Request starting HTTP/2 POST https://localhost:7283/api/WaslaClient/MakeClientInvoiceForPackages - application/json-patch+json 557
[2025-07-21 17:36:28.216 +03:00  INF]  CORS policy execution successful.
[2025-07-21 17:36:28.379 +03:00  INF]  Executing endpoint 'Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App)'
[2025-07-21 17:36:28.405 +03:00  INF]  Route matched with {action = "MakeClientInvoiceForPackages", controller = "WaslaClient"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MakeClientInvoiceForPackages(System.Collections.Generic.List`1[WaslaApp.Data.Models.invoices.InvoiceReq]) on controller Wasla_App.Controllers.WaslaClientController (Wasla_App).
[2025-07-21 17:36:52.469 +03:00  INF]  Executing OkObjectResult, writing value of type 'WaslaApp.Data.Models.invoices.InvoiceResponse'.
[2025-07-21 17:36:52.510 +03:00  INF]  Executed action Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App) in 24100.0067ms
[2025-07-21 17:36:52.510 +03:00  INF]  Executed endpoint 'Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App)'
[2025-07-21 17:36:52.512 +03:00  INF]  Request finished HTTP/2 POST https://localhost:7283/api/WaslaClient/MakeClientInvoiceForPackages - 200 57 application/json; charset=utf-8 24307.9066ms
[2025-07-21 17:37:26.913 +03:00  INF]  Request starting HTTP/2 POST https://localhost:7283/api/WaslaClient/MakeClientInvoiceForPackages - application/json-patch+json 558
[2025-07-21 17:37:26.920 +03:00  INF]  CORS policy execution successful.
[2025-07-21 17:37:26.928 +03:00  INF]  Executing endpoint 'Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App)'
[2025-07-21 17:37:26.929 +03:00  INF]  Route matched with {action = "MakeClientInvoiceForPackages", controller = "WaslaClient"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] MakeClientInvoiceForPackages(System.Collections.Generic.List`1[WaslaApp.Data.Models.invoices.InvoiceReq]) on controller Wasla_App.Controllers.WaslaClientController (Wasla_App).
[2025-07-21 17:37:39.330 +03:00  INF]  Executed DbCommand (60ms) [Parameters=[@__taxId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.tax_id, a.tax_amount, a.tax_code, a.tax_name, a.tax_sign
FROM "ApplyTax" AS a
WHERE a.tax_id = @__taxId_0
LIMIT 2
[2025-07-21 17:37:39.454 +03:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "InvoiceMain" AS i
[2025-07-21 17:37:39.479 +03:00  INF]  Executed DbCommand (7ms) [Parameters=[@__8__locals1_client_id_0='?', @__main_active_1='?' (DbType = Boolean), @__main_invoice_code_2='?', @__main_invoice_date_3='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT i.invoice_id, i.active, i.client_email, i.client_id, i.client_name, i.copoun_id, i.curr_code, i.discount, i.grand_total_price, i.invoice_code, i.invoice_code_auto, i.invoice_date, i.status, i.tax_id, i.total_price
FROM "InvoiceMain" AS i
WHERE i.client_id = @__8__locals1_client_id_0 AND i.active = @__main_active_1 AND i.invoice_code = @__main_invoice_code_2 AND i.invoice_date = @__main_invoice_date_3
LIMIT 2
[2025-07-21 17:37:39.492 +03:00  INF]  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT max(i.invoice_id)
FROM "InvoiceMain" AS i
[2025-07-21 17:37:39.650 +03:00  INF]  Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = Boolean), @p2='?', @p3='?', @p4='?', @p5='?' (DbType = Decimal), @p6='?', @p7='?' (DbType = Decimal), @p8='?' (DbType = Decimal), @p9='?', @p10='?', @p11='?' (DbType = DateTime2), @p12='?' (DbType = Int16), @p13='?' (DbType = Int32), @p14='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "InvoiceMain" (invoice_id, active, client_email, client_id, client_name, copoun_id, curr_code, discount, grand_total_price, invoice_code, invoice_code_auto, invoice_date, status, tax_id, total_price)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13, @p14);
[2025-07-21 17:37:39.664 +03:00  INF]  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT count(*)::int
FROM "ClientServices" AS c
[2025-07-21 17:37:39.673 +03:00  INF]  Executed DbCommand (1ms) [Parameters=[@__service_client_id_0='?', @__service_productId_1='?' (DbType = Int32), @__service_package_id_2='?' (DbType = Int32), @__service_invoice_id_3='?' (DbType = Decimal), @__8__locals2_row_service_package_id_4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT c.id, c.active, c.client_id, c.invoice_id, c.package_id, c."productId", c.service_package_id
FROM "ClientServices" AS c
WHERE c.client_id = @__service_client_id_0 AND c."productId" = @__service_productId_1 AND c.package_id = @__service_package_id_2 AND c.invoice_id = @__service_invoice_id_3 AND c.active AND c.service_package_id = @__8__locals2_row_service_package_id_4
LIMIT 2
[2025-07-21 17:37:39.677 +03:00  INF]  Executed DbCommand (0ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT max(c.id)
FROM "ClientServices" AS c
[2025-07-21 17:37:39.705 +03:00  INF]  Executed DbCommand (1ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = Decimal), @p4='?' (DbType = Int32), @p5='?' (DbType = Int32), @p6='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "ClientServices" (id, active, client_id, invoice_id, package_id, "productId", service_package_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6);
[2025-07-21 17:37:39.769 +03:00  INF]  Executed DbCommand (6ms) [Parameters=[@__clientId_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT c.client_birthday, c.client_email, c.client_id, c.client_name, c.fb_link, c.gender, c.lang, c.nation, c.pay_code, c.phone_number, c.profile_id, c.twitter_link, c.address
FROM "ClientProfile" AS c
WHERE c.client_id = @__clientId_0
[2025-07-21 17:38:15.717 +03:00  INF]  Executing OkObjectResult, writing value of type 'System.Boolean'.
[2025-07-21 17:38:15.718 +03:00  INF]  Executed action Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App) in 48789.0095ms
[2025-07-21 17:38:15.718 +03:00  INF]  Executed endpoint 'Wasla_App.Controllers.WaslaClientController.MakeClientInvoiceForPackages (Wasla_App)'
[2025-07-21 17:38:15.766 +03:00  INF]  Request finished HTTP/2 POST https://localhost:7283/api/WaslaClient/MakeClientInvoiceForPackages - 200 4 application/json; charset=utf-8 48853.3657ms
